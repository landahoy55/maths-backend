{"version":3,"sources":["../../src/controller/subTopicResult.js"],"names":["config","db","api","post","req","res","newSubTopicResult","achieved","body","score","subtopic","id","save","err","send","json","createdId","_id","put","findById","params","subtopicresult","message","get","find","subtopicresults","populate","path","model","exec"],"mappings":";;;;;;AAAA;;;;AACA;;AAGA;;;;AACA;;;;AAGA;;;;kBAEe,gBAAkB;AAAA,QAAhBA,MAAgB,QAAhBA,MAAgB;AAAA,QAARC,EAAQ,QAARA,EAAQ;;AAC7B,QAAIC,MAAM,sBAAV;;AAEA;AACAA,QAAIC,IAAJ,CAAS,aAAT,gCAAsC,UAACC,GAAD,EAAMC,GAAN,EAAc;AAChD,YAAIC,oBAAoB,8BAAxB;;AAEAA,0BAAkBC,QAAlB,GAA6BH,IAAII,IAAJ,CAASD,QAAtC;AACAD,0BAAkBG,KAAlB,GAA0BL,IAAII,IAAJ,CAASC,KAAnC;AACAH,0BAAkBI,QAAlB,GAA6BN,IAAII,IAAJ,CAASE,QAAtC;AACAJ,0BAAkBK,EAAlB,GAAuBP,IAAII,IAAJ,CAASG,EAAhC;;AAEAL,0BAAkBM,IAAlB,CAAuB,eAAO;AAC1B,gBAAIC,GAAJ,EAAS;AACLR,oBAAIS,IAAJ,CAASD,GAAT;AACH;AACD;AACAR,gBAAIU,IAAJ,CAAS,EAAEC,WAAWV,kBAAkBW,GAA/B,EAAT;AACA;AACH,SAPD;AAQH,KAhBD;;AAkBA;AACAf,QAAIgB,GAAJ,CAAQ,iBAAR,gCAAyC,UAACd,GAAD,EAAMC,GAAN,EAAc;AACnD,iCAAec,QAAf,CAAwBf,IAAIgB,MAAJ,CAAWT,EAAnC,EAAuC,UAACE,GAAD,EAAMQ,cAAN,EAAyB;AAC5D,gBAAIR,GAAJ,EAAS;AACLR,oBAAIS,IAAJ,CAASD,GAAT;AACH;AACDQ,2BAAed,QAAf,GAA0BH,IAAII,IAAJ,CAASD,QAAnC;AACAc,2BAAeZ,KAAf,GAAuBL,IAAII,IAAJ,CAASC,KAAhC;AACAY,2BAAeX,QAAf,GAA0BN,IAAII,IAAJ,CAASE,QAAnC;AACAW,2BAAeV,EAAf,GAAoBP,IAAII,IAAJ,CAASG,EAA7B;AACAU,2BAAeT,IAAf,CAAoB,eAAO;AACvB,oBAAIC,GAAJ,EAAS;AACLR,wBAAIS,IAAJ,CAASD,GAAT;AACH;AACDR,oBAAIU,IAAJ,CAAS,EAACO,SAAS,kBAAV,EAAT;AACH,aALD;AAMH,SAdD;AAeH,KAhBD;;AAkBA;AACApB,QAAIqB,GAAJ,CAAQ,cAAR,gCAAsC,UAACnB,GAAD,EAAMC,GAAN,EAAc;AAChD,iCAAemB,IAAf,CAAoB,EAAEb,IAAGP,IAAIgB,MAAJ,CAAWT,EAAhB,EAApB,EAA0C,UAACE,GAAD,EAAMY,eAAN,EAA0B;AAChE,gBAAIZ,GAAJ,EAAS;AACLR,oBAAIS,IAAJ,CAASD,GAAT;AACH;AACDR,gBAAIU,IAAJ,CAASU,eAAT;AACH,SALD;AAMH,KAPD;;AASA;AACAvB,QAAIqB,GAAJ,CAAQ,yBAAR,gCAAiD,UAACnB,GAAD,EAAMC,GAAN,EAAc;AAC3D,iCAAemB,IAAf,CAAoB,EAAEb,IAAGP,IAAIgB,MAAJ,CAAWT,EAAhB,EAApB,EACKe,QADL,CACc,EAACC,MAAM,UAAP,EAAmBC,OAAO,UAA1B,EAAsCF,UAAU,EAACC,MAAM,aAAP,EAAsBC,OAAO,OAA7B,EAAhD,EADd,EAEKF,QAFL,CAEc,IAFd,EAGKG,IAHL,CAII,UAAChB,GAAD,EAAMY,eAAN,EAA0B;AACtB,gBAAIZ,GAAJ,EAAS;AACLR,oBAAIS,IAAJ,CAASD,GAAT;AACH;AACDR,gBAAIU,IAAJ,CAASU,eAAT;AACH,SATL;AAWH,KAZD;;AAcA,WAAOvB,GAAP;AACH,C;;AAED;AACA;AACA;AACA;AACA;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AA9FA;;;AAJA","file":"subTopicResult.js","sourcesContent":["import mongoose from 'mongoose';\nimport { Router } from 'express';\n\n//import models\nimport Subtopic from '../model/subTopic';\nimport SubTopicResult from '../model/subTopicResult';\n\n//Auth middleware\nimport { authenticate } from '../middleware/authMiddleware';\n\nexport default ({config, db}) => {\n    let api = Router();\n\n    //post result\n    api.post('/postresult', authenticate, (req, res) => {\n        let newSubTopicResult = new SubTopicResult();\n        \n        newSubTopicResult.achieved = req.body.achieved\n        newSubTopicResult.score = req.body.score\n        newSubTopicResult.subtopic = req.body.subtopic\n        newSubTopicResult.id = req.body.id\n\n        newSubTopicResult.save(err => {\n            if (err) {\n                res.send(err)\n            }\n            // res.json({ message: 'subtopic result saved' });\n            res.json({ createdId: newSubTopicResult._id });\n            // res.send(result)\n        });\n    });\n\n    //update result - fetch result by id, then update all params\n    api.put('/postresult/:id', authenticate, (req, res) => {\n        SubTopicResult.findById(req.params.id, (err, subtopicresult) => {\n            if (err) {\n                res.send(err)\n            }\n            subtopicresult.achieved = req.body.achieved\n            subtopicresult.score = req.body.score\n            subtopicresult.subtopic = req.body.subtopic\n            subtopicresult.id = req.body.id\n            subtopicresult.save(err => {\n                if (err) {\n                    res.send(err);\n                }\n                res.json({message: \"SubTopic Updated\"});\n            })\n        })\n    });\n\n    //get all results - based on user\n    api.get('/getbyid/:id', authenticate, (req, res) => {\n        SubTopicResult.find({ id:req.params.id }, (err, subtopicresults) => {\n            if (err) {\n                res.send(err);\n            }\n            res.json(subtopicresults);\n        });\n    });\n\n    //get all results - and populate - by user\n    api.get('/getandpopulatebyid/:id', authenticate, (req, res) => {\n        SubTopicResult.find({ id:req.params.id })\n            .populate({path: 'subtopic', model: 'SubTopic', populate: {path: 'parentTopic', model: 'Topic'}})\n            .populate('id')\n            .exec(\n            (err, subtopicresults) => {\n                if (err) {\n                    res.send(err);\n                }\n                res.json(subtopicresults)\n            }\n        )\n    });\n\n    return api;\n};\n\n// .populate({path: 'subTopicResults', model: 'SubTopicResult', populate: {path: 'subtopic', model: 'SubTopic', populate: {path: 'topic', model: 'Topic'}}})\n// .populate('id')\n// .populate('topic')\n// .populate('subtopic')\n// .exec(\n\n\n\n// SubTopicResult.find({ id:req.params.id }, (err, subtopicresults) => {\n//     if (err) {\n//         res.send(err);\n//     }\n//     res.json(subtopicresults)\n// });\n// Topic.find({}).populate('subTopics').exec(\n//     function(err, topic) {\n//         if (err) {\n//             res.send(err)\n//         }\n//         console.log(JSON.stringify(topic));\n//         res.json(topic);\n//     }\n// );"]}